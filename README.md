# ①課題番号-プロダクト名

kadai11_php_all

## ②課題内容（どんな作品か）

- 名前、内容、位置情報、写真を投稿＆表示できるアプリ。
- ユーザーの新規登録ができます。マイページで登録情報の変更・退会と投稿を選択して削除することができます。
- 管理画面から投稿やユーザーを選択して削除することができます。
- 位置情報を取得した投稿は地図上にピンとポップアップで表示されます。
- 地図上から気になる投稿にダイレクトにアクセスできます。

## ③DEMO

https://723kb.jp/kadai11_php_all/

## ④作ったアプリケーション用のIDまたはPasswordがある場合

【一般ユーザー】
- ID: test1
- PW: 1111

【管理者】
- ID: admin1
- PW: 2222

- 新規登録から自由にユーザー登録できます。
  管理者として登録したい場合は、追加で管理者用パスワード1111を入力して登録してください。

## ⑤工夫した点・こだわった点

- マイページの作成、ユーザー自身で登録内容を変更できるようにしSNSとしての最低限必要な機能は実装できた。
  ユーザー名を変更したときに、過去に投稿した内容のユーザー名も連動して変更できるようにした。
- map.phpで投稿をクリックすると自動で地図にスクロールし、かつその投稿のポップアップが中央に配置されるようにした。
- GoogleMapではなくオープンソースの地図OpenStreetMapを利用した。地図を表示させるためのライブラリはLeafletを使用した。

## ⑥難しかった点・次回トライしたいこと(又は機能)

【未実装、要修正点】
- 現在のいいねの状態を保持する挙動がおかしい時がある（いいねを消してカウントは減ってもハートが赤いままだったり、その反対も）。→まだなおせていないのでなおす。
- パスワードやIDを英数字、記号、大文字など含めたり、桁数の制限をつけたい。
- phpのファイルだらけになりsrcフォルダにまとめようとしたが、パスの指定が変わりとんでもないことになり断念した。→ベースパスでの指定など考えたが結局うまくいかずできていない。
- 投稿と地図においてデータの取り扱いをもっと考えて実装する（今はとりあえず現在地を取得してその情報を地図に反映しただけ。もっと位置情報にどんな意味を持たせるのか考える）。
- OpenStreetMapをもっと自分流の地図にアレンジしてみたい。
- map.phpで地図上でハンバーガーメニューを開くと、地図にはz-indexがついていないのに地図が最上面にきてしまう。
- 管理者としてログインしマイページで一般ユーザーに変更。データベースでは管理フラグ0で一般ユーザーだが投稿ページで管理者扱い（全投稿に削除ボタンが表示されている）となっている。
- コードが長く読みにくい。リファクタリング必要。

【卒制への展望】
- API課題[https://github.com/723kb/kadai05_api] で取り組んだことと今回のPHP課題で取り組んだ掲示板機能を組み合わせて、ユーザーが駅の情報を投稿＆検索できるようなものを作りたい。
  地図上から投稿したい駅を選択し投稿できるようにもしたい。
  現状としてmap.phpはデフォルトで東京駅が中心に来るように表示しているが、ユーザーの位置を中心に持ってくるようにしたい。


## ⑦質問・疑問・感想、シェアしたいこと等なんでも

- [感想]users_tableのusernameが変更になった時、msgs_tableのnameも連動して変更する部分の実装が難しかった。今回機能実装のために様々なSQL文を使い、かなり頭が混乱した。
- [参考記事]
  - 1. JOIN[https://qiita.com/ysda/items/0d473e644409e45965d7] [https://qiita.com/Yinaura/items/3ab6fc49ae55f52e2d55]